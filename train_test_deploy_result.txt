/home/alanliu/PycharmProjects/data_collector/.venv/bin/python /home/alanliu/PycharmProjects/data_collector/edge_orientation_classification_all_surface_planE.py 
Epoch 0 [Train]: 100%|██████████| 1758/1758 [02:19<00:00, 12.56batch/s]
Epoch 0 Train Loss: 2.3720, Train Acc: 18.33%  (阶段耗时 139.9s)
Epoch 0 [Val]: 100%|██████████| 375/375 [00:24<00:00, 15.40batch/s]
🔖 保存了新的最佳模型
Epoch 0 Val Loss: 1.7676, Val Acc: 31.93%  (阶段耗时 24.4s)
Epoch 1 [Train]: 100%|██████████| 1758/1758 [02:16<00:00, 12.88batch/s]
Epoch 1 Train Loss: 1.2593, Train Acc: 47.75%  (阶段耗时 136.5s)
Epoch 1 [Val]: 100%|██████████| 375/375 [00:21<00:00, 17.54batch/s]
🔖 保存了新的最佳模型
Epoch 1 Val Loss: 0.8222, Val Acc: 64.47%  (阶段耗时 21.4s)
Epoch 2 [Train]: 100%|██████████| 1758/1758 [02:14<00:00, 13.09batch/s]
Epoch 2 Train Loss: 0.6786, Train Acc: 70.79%  (阶段耗时 134.3s)
Epoch 2 [Val]: 100%|██████████| 375/375 [00:21<00:00, 17.54batch/s]
🔖 保存了新的最佳模型
Epoch 2 Val Loss: 0.3855, Val Acc: 83.87%  (阶段耗时 21.4s)
Epoch 3 [Train]: 100%|██████████| 1758/1758 [02:15<00:00, 12.95batch/s]
Epoch 3 Train Loss: 0.3657, Train Acc: 85.54%  (阶段耗时 135.7s)
Epoch 3 [Val]: 100%|██████████| 375/375 [00:21<00:00, 17.66batch/s]
🔖 保存了新的最佳模型
Epoch 3 Val Loss: 0.3438, Val Acc: 87.93%  (阶段耗时 21.2s)
Epoch 4 [Train]: 100%|██████████| 1758/1758 [02:16<00:00, 12.87batch/s]
Epoch 4 Train Loss: 0.2060, Train Acc: 92.92%  (阶段耗时 136.6s)
Epoch 4 [Val]: 100%|██████████| 375/375 [00:21<00:00, 17.51batch/s]
🔖 保存了新的最佳模型
Epoch 4 Val Loss: 0.1326, Val Acc: 96.20%  (阶段耗时 21.4s)
Epoch 5 [Train]: 100%|██████████| 1758/1758 [02:16<00:00, 12.87batch/s]
Epoch 5 Train Loss: 0.1496, Train Acc: 95.19%  (阶段耗时 136.6s)
Epoch 5 [Val]: 100%|██████████| 375/375 [00:21<00:00, 17.33batch/s]
EarlyStopping counter: 1/5
Epoch 5 Val Loss: 0.1916, Val Acc: 92.93%  (阶段耗时 21.6s)
Epoch 6 [Train]: 100%|██████████| 1758/1758 [02:16<00:00, 12.85batch/s]
Epoch 6 Train Loss: 0.1144, Train Acc: 96.46%  (阶段耗时 136.8s)
Epoch 6 [Val]: 100%|██████████| 375/375 [00:21<00:00, 17.42batch/s]
🔖 保存了新的最佳模型
Epoch 6 Val Loss: 0.0730, Val Acc: 97.13%  (阶段耗时 21.5s)
Epoch 7 [Train]: 100%|██████████| 1758/1758 [02:16<00:00, 12.89batch/s]
Epoch 7 Train Loss: 0.0960, Train Acc: 97.00%  (阶段耗时 136.4s)
Epoch 7 [Val]: 100%|██████████| 375/375 [00:21<00:00, 17.52batch/s]
EarlyStopping counter: 1/5
Epoch 7 Val Loss: 0.1319, Val Acc: 95.60%  (阶段耗时 21.4s)
Epoch 8 [Train]: 100%|██████████| 1758/1758 [02:17<00:00, 12.74batch/s]
Epoch 8 Train Loss: 0.0905, Train Acc: 97.51%  (阶段耗时 138.0s)
Epoch 8 [Val]: 100%|██████████| 375/375 [00:21<00:00, 17.48batch/s]
EarlyStopping counter: 2/5
Epoch 8 Val Loss: 0.0866, Val Acc: 97.53%  (阶段耗时 21.5s)
Epoch 9 [Train]: 100%|██████████| 1758/1758 [02:16<00:00, 12.84batch/s]
Epoch 9 Train Loss: 0.0675, Train Acc: 98.07%  (阶段耗时 136.9s)
Epoch 9 [Val]: 100%|██████████| 375/375 [00:21<00:00, 17.68batch/s]
🔖 保存了新的最佳模型
Epoch 9 Val Loss: 0.0190, Val Acc: 99.47%  (阶段耗时 21.2s)
Epoch 10 [Train]: 100%|██████████| 1758/1758 [02:17<00:00, 12.82batch/s]
Epoch 10 Train Loss: 0.0752, Train Acc: 97.88%  (阶段耗时 137.1s)
Epoch 10 [Val]: 100%|██████████| 375/375 [00:21<00:00, 17.31batch/s]
EarlyStopping counter: 1/5
Epoch 10 Val Loss: 0.0259, Val Acc: 99.40%  (阶段耗时 21.7s)
Epoch 11 [Train]: 100%|██████████| 1758/1758 [02:17<00:00, 12.81batch/s]
Epoch 11 Train Loss: 0.0612, Train Acc: 98.36%  (阶段耗时 137.2s)
Epoch 11 [Val]: 100%|██████████| 375/375 [00:21<00:00, 17.51batch/s]
EarlyStopping counter: 2/5
Epoch 11 Val Loss: 0.0653, Val Acc: 97.60%  (阶段耗时 21.4s)
Epoch 12 [Train]: 100%|██████████| 1758/1758 [02:17<00:00, 12.80batch/s]
Epoch 12 Train Loss: 0.0626, Train Acc: 98.31%  (阶段耗时 137.3s)
Epoch 12 [Val]: 100%|██████████| 375/375 [00:21<00:00, 17.30batch/s]
EarlyStopping counter: 3/5
Epoch 12 Val Loss: 0.0317, Val Acc: 99.13%  (阶段耗时 21.7s)
Epoch 13 [Train]: 100%|██████████| 1758/1758 [02:18<00:00, 12.74batch/s]
Epoch 13 Train Loss: 0.0551, Train Acc: 98.59%  (阶段耗时 138.0s)
Epoch 13 [Val]: 100%|██████████| 375/375 [00:21<00:00, 17.36batch/s]
🔖 保存了新的最佳模型
Epoch 13 Val Loss: 0.0107, Val Acc: 99.73%  (阶段耗时 21.6s)
Epoch 14 [Train]: 100%|██████████| 1758/1758 [02:17<00:00, 12.79batch/s]
Epoch 14 Train Loss: 0.0564, Train Acc: 98.66%  (阶段耗时 137.5s)
Epoch 14 [Val]: 100%|██████████| 375/375 [00:21<00:00, 17.53batch/s]
EarlyStopping counter: 1/5
Epoch 14 Val Loss: 0.0135, Val Acc: 99.67%  (阶段耗时 21.4s)
Epoch 15 [Train]: 100%|██████████| 1758/1758 [02:18<00:00, 12.73batch/s]
Epoch 15 Train Loss: 0.0423, Train Acc: 98.69%  (阶段耗时 138.1s)
Epoch 15 [Val]: 100%|██████████| 375/375 [00:21<00:00, 17.34batch/s]
EarlyStopping counter: 2/5
Epoch 15 Val Loss: 0.0164, Val Acc: 99.60%  (阶段耗时 21.6s)
Epoch 16 [Train]: 100%|██████████| 1758/1758 [02:18<00:00, 12.72batch/s]
Epoch 16 Train Loss: 0.0377, Train Acc: 99.13%  (阶段耗时 138.3s)
Epoch 16 [Val]: 100%|██████████| 375/375 [00:21<00:00, 17.34batch/s]
EarlyStopping counter: 3/5
Epoch 16 Val Loss: 0.0134, Val Acc: 99.67%  (阶段耗时 21.6s)
Epoch 17 [Train]: 100%|██████████| 1758/1758 [02:17<00:00, 12.81batch/s]
Epoch 17 Train Loss: 0.0474, Train Acc: 98.82%  (阶段耗时 137.3s)
Epoch 17 [Val]: 100%|██████████| 375/375 [00:21<00:00, 17.48batch/s]
EarlyStopping counter: 4/5
Epoch 17 Val Loss: 0.0502, Val Acc: 98.27%  (阶段耗时 21.5s)
Epoch 18 [Train]: 100%|██████████| 1758/1758 [02:18<00:00, 12.74batch/s]
Epoch 18 Train Loss: 0.0402, Train Acc: 98.82%  (阶段耗时 138.0s)
Epoch 18 [Val]: 100%|██████████| 375/375 [00:21<00:00, 17.32batch/s]
🔖 保存了新的最佳模型
Epoch 18 Val Loss: 0.0087, Val Acc: 99.80%  (阶段耗时 21.7s)
Epoch 19 [Train]: 100%|██████████| 1758/1758 [02:16<00:00, 12.87batch/s]
Epoch 19 Train Loss: 0.0264, Train Acc: 99.32%  (阶段耗时 136.6s)
Epoch 19 [Val]: 100%|██████████| 375/375 [00:21<00:00, 17.45batch/s]
EarlyStopping counter: 1/5
Epoch 19 Val Loss: 0.0246, Val Acc: 99.27%  (阶段耗时 21.5s)
Epoch 20 [Train]: 100%|██████████| 1758/1758 [02:18<00:00, 12.71batch/s]
Epoch 20 Train Loss: 0.0354, Train Acc: 99.13%  (阶段耗时 138.3s)
Epoch 20 [Val]: 100%|██████████| 375/375 [00:21<00:00, 17.45batch/s]
EarlyStopping counter: 2/5
Epoch 20 Val Loss: 0.1547, Val Acc: 95.87%  (阶段耗时 21.5s)
Epoch 21 [Train]: 100%|██████████| 1758/1758 [02:18<00:00, 12.72batch/s]
Epoch 21 Train Loss: 0.0226, Train Acc: 99.40%  (阶段耗时 138.2s)
Epoch 21 [Val]: 100%|██████████| 375/375 [00:21<00:00, 17.56batch/s]
EarlyStopping counter: 3/5
Epoch 21 Val Loss: 0.0547, Val Acc: 98.13%  (阶段耗时 21.4s)
Epoch 22 [Train]: 100%|██████████| 1758/1758 [02:17<00:00, 12.83batch/s]
Epoch 22 Train Loss: 0.0390, Train Acc: 98.91%  (阶段耗时 137.0s)
Epoch 22 [Val]: 100%|██████████| 375/375 [00:21<00:00, 17.30batch/s]
EarlyStopping counter: 4/5
Epoch 22 Val Loss: 0.0090, Val Acc: 99.80%  (阶段耗时 21.7s)
Epoch 23 [Train]: 100%|██████████| 1758/1758 [02:18<00:00, 12.69batch/s]
Epoch 23 Train Loss: 0.0152, Train Acc: 99.70%  (阶段耗时 138.6s)
Epoch 23 [Val]: 100%|██████████| 375/375 [00:21<00:00, 17.21batch/s]
EarlyStopping counter: 5/5
⏹ 触发 EarlyStopping，退出训练
Test Evaluation: 100%|██████████| 382/382 [00:21<00:00, 17.69batch/s]

🎯 Test Accuracy: 99.67%  (测试耗时 21.6s)
Network is valid
The SNN is deployed on the core: [0, 1, 2, 3]
label: 9, prediction: 9， current ACC：0.9163398692810457， output spikes num: 130: 100%|██████████| 1530/1530 [32:14<00:00,  1.26s/it]
On chip inference accuracy: 0.9163398692810457

进程已结束，退出代码为 0

